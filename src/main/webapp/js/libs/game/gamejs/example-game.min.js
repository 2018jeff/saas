function ExampleGame(c){var f=new SeedableRandom();var h=new Date;f.seed(h.getTime());X_SEPARATION=300;Y_SEPARATION=150;function e(j){this.type="player";var r=20;var o=3;var i=3;var k=2;var n=this.pos=[c.width/2,c.height/2];var q=0;var l=0;var d=new Sprite(["center","bottom"],{stand:[["img/character-stand.png",0],],"walk right":[["img/character-walk-right-1.png",i],["img/character-walk-right-2.png",i],["img/character-walk-right-3.png",i],["img/character-walk-right-2.png",i],],"walk left":[["img/character-walk-left-1.png",i],["img/character-walk-left-2.png",i],["img/character-walk-left-3.png",i],["img/character-walk-left-2.png",i],],fall:[["img/character-fall-1.png",k],["img/character-fall-2.png",k],],},function(){d.action("stand")});this.draw=function(p){d.draw(p,j.camera(n))};this.updateanimation=function(){if(l>j.gravity*2){d.action("fall")}else{if(q>=o){d.action("walk right")}else{if(q<=-o){d.action("walk left")}else{d.action("stand")}}}};this.update=function(){l=Math.min(l+j.gravity,r);this.updateanimation();n[0]+=q;n[1]+=l;d.update();if(n[1]>d.height+c.height||n[1]<0){document.getElementById("gameover").style.paddingTop=c.height/2-100;document.getElementById("gameover").style.display="block"}};this.get_collision_aabb=function(){return d.aabb(n)};this.keyDown_37=function(){this.updateanimation();q=-o};this.keyUp_37=this.keyUp_39=function(){this.updateanimation();q=0};this.keyDown_39=function(){this.updateanimation();q=o};var m=function(p,s){return p[0]<s[0]?1:p[0]>s[0]?-1:0};this.collide_aabb=function(p){if(p.type=="platform"){var t=this.get_collision_aabb();var v=p.get_collision_aabb();var s=[[v[1]-(t[1]+t[3]),1,1],[v[0]-(t[0]+t[2]),0,1],[t[0]-(v[0]+v[2]),0,-1],[t[1]-(v[1]+v[3]),1,-1]];s.sort(m);var u=s[0];if(u[1]){if(n[0]>v[0]+v[2]){n[0]+=o}else{if(n[0]<v[0]){n[0]-=o}else{n[1]=v[1];l=0;this.updateanimation()}}}else{if(n[0]>v[0]+v[2]){n[0]+=o}else{if(n[0]<v[0]){n[0]-=o}}}}}}function g(j,i){this.type="prop";var d=null;var l=0;if(f.nextInt(0,5)==0){d="img/prop-"+["tyre","lamp","bench"][f.nextInt(0,3)]+".png"}else{d="img/tree";if(f.nextInt(0,2)){d+="-pine"}d+="-"+f.nextInt(1,4)+".png"}var k=new Sprite(["center","bottom"],{"default":[[d,0]]},function(){k.action("default");l=(f.next()-0.5)*(i.get_collision_aabb()[2]-k.width/2)});this.draw=function(m){k.draw(m,j.camera([i.pos[0]+l,i.pos[1]+1]))}}function a(j,l){this.type="platform";var i=[];this.pos=l;var d=this;var k=this.sprite=new Sprite(["center","top"],{"default":[["img/platform-"+f.nextInt(1,5)+".png",0]]},function(){k.action("default")});this.init=function(){for(var m=0;m<f.nextInt(1,4);m++){i.push(new g(j,this));c.addEntity(i[i.length-1])}};this.update=function(){l[1]-=j.upspeed;if(l[1]<-200){for(var m=0;m<i.length;m++){c.delEntity(i[m]);delete i[m]}c.delEntity(this);j.remove(this)}k.update()};this.draw=function(m){k.draw(m,j.camera(l))};this.get_collision_aabb=function(){return k.aabb(l)}}function b(){this.gravity=0.4;this.upspeed=1;this.cpos=c.width/2;this.distance=0;var k=0;var j="rgba(240, 255, 255, 1.0)";var i=new e(this);var d=[];this.camera=function(l){return[l[0]-this.cpos+c.width/2,l[1]]};this.init=function(){c.addEntity(i);d.push(c.addEntity(new a(this,[c.width/2,c.height/2])));for(var l=c.height/2+Y_SEPARATION;l<c.height+Y_SEPARATION;l+=Y_SEPARATION){this.addrow(l)}};this.draw=function(){c.background(j)};this.update=function(){collide.aabb([i],d);this.cpos+=(i.pos[0]-this.cpos)*0.5;this.distance+=this.upspeed;if(Math.floor(this.distance/Y_SEPARATION)>k){k=Math.floor(this.distance/Y_SEPARATION);this.addrow(c.height+Y_SEPARATION)}this.upspeed+=0.001};this.pointerDown=function(){if(c.pointerPosition[0]<c.width/2){i.keyDown_37()}else{i.keyDown_39()}};this.pointerUp=function(){i.keyUp_37()};this.pointerBox=function(){return[0,0,c.width,c.height]};this.remove=function(l){d.remove(l);c.delEntity(l)};this.addrow=function(m){for(var l=i.pos[0]-c.width/2;l<i.pos[0]+c.width/2;l+=X_SEPARATION){d.push(c.addEntity(new a(this,[l,m])))}}}Sprite.preload(["img/character-fall-1.png","img/character-fall-2.png","img/character-stand.png","img/character-walk-left-1.png","img/character-walk-left-2.png","img/character-walk-left-3.png","img/character-walk-right-1.png","img/character-walk-right-2.png","img/character-walk-right-3.png","img/makeleft.sh","img/platform-1.png","img/platform-2.png","img/platform-3.png","img/platform-4.png","img/prop-bench.png","img/prop-lamp.png","img/prop-tyre.png","img/tree-1.png","img/tree-2.png","img/tree-3.png","img/tree-pine-1.png","img/tree-pine-2.png","img/tree-pine-3.png",],function(){c.addEntity(new b())})}function launch(){var a=document.getElementById("surface");var c=document.createElement("canvas");c.style.width=c.width=(a.offsetWidth+1);c.style.height=c.height=(a.offsetHeight+1);a.appendChild(c);var b=new JSGameSoup(c,30);ExampleGame(b);b.launch()};